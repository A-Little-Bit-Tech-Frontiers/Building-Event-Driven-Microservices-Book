# 10. 기본 프로듀서/컨슈머 마이크로서비스

**기본 프로듀서/컨슈머(Basic producer and consumer, BPC)** 란 하나 이상의 이벤트 스트림에서 이벤트를  입력받아 필요한 비즈니스 로직을 적용해 가공 및 필요 시 출력 이벤트 스트림에 이벤트를 내보내는 마이크로서비스다. 기본적인 프로듀서/컨슈머 클라이언트를 사용하며, **구체적인 스케줄링, 체인지로그 등의 작업은 하지 않는다.**

### BPC 가 필요한 Use-case

- **레거시 시스템에 통합**
    - 기존 시스템에서 이벤트 브로커의 단일 진실 공급원에 필요한 만큼 자신의 데이터를 생산하고 자신이 필요한 이벤트는 다른 스트림에서 소비한다.
    - **ex. 사이드카 패턴**
        - **레거시 코드베이스를 수정하기에 안전하지 않을 경우** 사용하면 좋은 패턴이다. **‘사이드카 구현체’** 서비스를 별도로 만들어서 기존 서비스의 데이터를 이 서비스의 데이터 저장소에 동기화(Sync or Upsert) 한다. Front-end 는 이 사이드카 서비스에서 데이터를 사용한다.
- **이벤트 순서가 중요하지 않은 상태 저장 비즈니스 로직**
    - **최종적으로 데이터 세트가 도착하기만 하면 되는 패턴**을 구현하기에 좋다. (누락이 아닌, 모두 도착은 해야 한다는 조건) 이 패턴을 구현할 때는 **이벤트가 도착할 때마다 기존 데이터의 상태가 저장되었는지 쿼리하는 과정**이 필요하다.
- **데이터 레이어에서 많은 일을 하는 경우**
    - AI 나 머신러닝 서비스를 만드는 경우 하부 데이터 레이어에서 처리되는 로직이 많다. (AI 추론 기능 등) 이런 경우 거대한 작업 단위로 단일 BPC 에 맡기는 용도로 사용하기에 적합하다.
- 시간대 별 처리 수요량이 다른 경우

### 하이브리드 BPC 앱으로 외부 스트리밍 처리

외부 스트림 프레임워크에서 **여러 이벤트를 조인하고**, **BPC 가 소비할 수 있는 형태로 가공하여** 조인된 이벤트용 스트림에 내보낸다. BPC 는 이 조인된 이벤트를 컨슘하고 비즈니스 로직을 처리하는 형태로 전체 프로세스가 설계된다. (ex. [Confluent KSQL](https://docs.confluent.io/platform/current/ksqldb/overview.html))
